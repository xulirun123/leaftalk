# å¶è¯­æ¶ˆæ¯ç³»ç»Ÿå®Œæ•´åŠŸèƒ½ç»†èŠ‚è§„æ ¼

## ğŸ¯ ç³»ç»Ÿæ€»ä½“æ¶æ„

### æŠ€æœ¯æ ˆç¡®å®š
- **å‰ç«¯æ¡†æ¶**: Vue3 + Vite + Pinia
- **æ•°æ®åº“**: MySQL 8.0 (æœåŠ¡å™¨ç«¯ä¸»å­˜å‚¨)
- **å®¢æˆ·ç«¯ç¼“å­˜**: IndexedDB + localStorage + å†…å­˜ç¼“å­˜
- **å®æ—¶é€šä¿¡**: ç°æœ‰ç»Ÿä¸€å®æ—¶æœåŠ¡å™¨ (unifiedRealtimeService)
- **æ–‡ä»¶å­˜å‚¨**: æœåŠ¡å™¨æ–‡ä»¶å­˜å‚¨ + å®¢æˆ·ç«¯ç¼“å­˜
- **ç°æœ‰ç»„ä»¶**: å¤ç”¨æ‰€æœ‰ç°æœ‰UIç»„ä»¶ï¼Œä¸ä¿®æ”¹ç»„ä»¶ç»“æ„

### å­˜å‚¨ç­–ç•¥
- **ä¸»å­˜å‚¨**: MySQLæœåŠ¡å™¨æ•°æ®åº“ (æ°¸ä¹…å¯é )
- **å®¢æˆ·ç«¯ç¼“å­˜**: ä¸‰çº§ç¼“å­˜æ¶æ„ (æ€§èƒ½ä¼˜åŒ–)
- **ç¦»çº¿æ”¯æŒ**: IndexedDBæœ¬åœ°ç¼“å­˜ + ç¦»çº¿æ“ä½œé˜Ÿåˆ—
- **æ•°æ®åŒæ­¥**: å¢é‡åŒæ­¥ + å†²çªè§£å†³

## ğŸ“± å®Œæ•´åŠŸèƒ½æ¨¡å—è¯¦ç»†è§„æ ¼

### 1. æ–‡æœ¬æ¶ˆæ¯æ¨¡å—
```typescript
interface TextMessageFeatures {
  // åŸºç¡€åŠŸèƒ½
  sendText: {
    input: string                    // æ–‡æœ¬å†…å®¹
    maxLength: 5000                  // æœ€å¤§é•¿åº¦é™åˆ¶
    supportEmoji: true               // æ”¯æŒè¡¨æƒ…ç¬¦å·
    supportMarkdown: false           // ä¸æ”¯æŒMarkdown
    autoSave: true                   // è‡ªåŠ¨ä¿å­˜è‰ç¨¿
  }
  
  // é«˜çº§åŠŸèƒ½
  mention: {
    trigger: '@'                     // @è§¦å‘ç¬¦
    searchUsers: true                // æœç´¢ç”¨æˆ·
    highlightMention: true           // é«˜äº®æ˜¾ç¤º@ç”¨æˆ·
    notification: true               // @æ—¶å‘é€é€šçŸ¥
  }
  
  // è¡¨æƒ…åŠŸèƒ½
  emoji: {
    picker: 'EmojiPicker.vue'        // ä½¿ç”¨ç°æœ‰è¡¨æƒ…é€‰æ‹©å™¨
    recentEmoji: true                // æœ€è¿‘ä½¿ç”¨è¡¨æƒ…
    customEmoji: false               // ä¸æ”¯æŒè‡ªå®šä¹‰è¡¨æƒ…
    emojiShortcuts: true             // æ”¯æŒè¡¨æƒ…å¿«æ·é”®
  }
  
  // è‰ç¨¿åŠŸèƒ½
  draft: {
    autoSave: true                   // è‡ªåŠ¨ä¿å­˜
    saveInterval: 2000               // 2ç§’ä¿å­˜é—´éš”
    maxDrafts: 100                   // æœ€å¤š100ä¸ªè‰ç¨¿
    crossDevice: false               // ä¸è·¨è®¾å¤‡åŒæ­¥è‰ç¨¿
  }
  
  // æ¶ˆæ¯çŠ¶æ€
  status: {
    sending: 'å‘é€ä¸­â³'
    sent: 'å·²å‘é€âœ“'
    delivered: 'å·²é€è¾¾âœ“âœ“'
    read: 'å·²è¯»âœ“âœ“'
    failed: 'å‘é€å¤±è´¥âŒ'
  }
}
```

### 2. è¯­éŸ³æ¶ˆæ¯æ¨¡å—
```typescript
interface VoiceMessageFeatures {
  // å½•éŸ³åŠŸèƒ½ (ä½¿ç”¨ç°æœ‰VoiceRecorder.vue)
  recording: {
    component: 'VoiceRecorder.vue'   // ç°æœ‰ç»„ä»¶
    maxDuration: 60                  // æœ€å¤§60ç§’
    minDuration: 1                   // æœ€å°1ç§’
    format: 'mp3'                    // éŸ³é¢‘æ ¼å¼
    quality: 'medium'                // éŸ³è´¨è®¾ç½®
    realTimeWaveform: true           // å®æ—¶æ³¢å½¢æ˜¾ç¤º
    pauseResume: true                // æ”¯æŒæš‚åœç»§ç»­
  }
  
  // æ’­æ”¾åŠŸèƒ½
  playback: {
    autoPlay: false                  // ä¸è‡ªåŠ¨æ’­æ”¾
    showProgress: true               // æ˜¾ç¤ºæ’­æ”¾è¿›åº¦
    playbackSpeed: [0.5, 1.0, 1.5, 2.0]  // æ’­æ”¾é€Ÿåº¦é€‰é¡¹
    backgroundPlay: true             // åå°æ’­æ”¾
    proximityPause: true             // æ¥è¿‘ä¼ æ„Ÿå™¨æš‚åœ
  }
  
  // è¯­éŸ³è½¬æ–‡å­—
  speechToText: {
    enabled: true                    // å¯ç”¨åŠŸèƒ½
    autoTranscribe: false            // ä¸è‡ªåŠ¨è½¬æ¢
    manualTranscribe: true           // æ‰‹åŠ¨è½¬æ¢
    language: 'zh-CN'                // ä¸­æ–‡è¯†åˆ«
    accuracy: 'high'                 // é«˜ç²¾åº¦æ¨¡å¼
    showTranscription: true          // æ˜¾ç¤ºè½¬æ¢ç»“æœ
  }
  
  // è¯­éŸ³è¾“å…¥
  voiceInput: {
    enabled: true                    // å¯ç”¨åŠŸèƒ½
    realTimeTranscribe: true         // å®æ—¶è½¬æ¢
    autoSend: false                  // ä¸è‡ªåŠ¨å‘é€
    editBeforeSend: true             // å‘é€å‰å¯ç¼–è¾‘
    fallbackToVoice: true            // è½¬æ¢å¤±è´¥å‘é€è¯­éŸ³
  }
  
  // è¯­éŸ³å¢å¼º
  enhancement: {
    noiseReduction: true             // é™å™ªå¤„ç†
    volumeNormalization: true        // éŸ³é‡æ ‡å‡†åŒ–
    autoGainControl: true            // è‡ªåŠ¨å¢ç›Šæ§åˆ¶
    echoCancellation: true           // å›å£°æ¶ˆé™¤
  }
}
```

### 3. å›¾ç‰‡æ¶ˆæ¯æ¨¡å—
```typescript
interface ImageMessageFeatures {
  // æ‹æ‘„åŠŸèƒ½ (ä½¿ç”¨ç°æœ‰WeChatCamera.vue)
  camera: {
    component: 'WeChatCamera.vue'    // ç°æœ‰ç›¸æœºç»„ä»¶
    frontBack: true                  // å‰åæ‘„åƒå¤´åˆ‡æ¢
    flash: true                      // é—ªå…‰ç¯æ§åˆ¶
    focusTap: true                   // ç‚¹å‡»å¯¹ç„¦
    gridLines: true                  // ç½‘æ ¼çº¿è¾…åŠ©
    aspectRatio: ['1:1', '4:3', '16:9']  // å®½é«˜æ¯”é€‰é¡¹
  }
  
  // å›¾ç‰‡é€‰æ‹©
  gallery: {
    multiSelect: true                // å¤šé€‰æ”¯æŒ
    maxSelect: 9                     // æœ€å¤š9å¼ 
    albumView: true                  // ç›¸å†Œè§†å›¾
    previewBeforeSend: true          // å‘é€å‰é¢„è§ˆ
    sortByDate: true                 // æŒ‰æ—¥æœŸæ’åº
  }
  
  // å›¾ç‰‡ç¼–è¾‘
  editing: {
    crop: true                       // è£å‰ªåŠŸèƒ½
    rotate: true                     // æ—‹è½¬åŠŸèƒ½
    filters: ['åŸå›¾', 'é»‘ç™½', 'å¤å¤', 'é²œè‰³', 'æŸ”å’Œ']  // æ»¤é•œé€‰é¡¹
    brightness: true                 // äº®åº¦è°ƒèŠ‚
    contrast: true                   // å¯¹æ¯”åº¦è°ƒèŠ‚
    addText: true                    // æ·»åŠ æ–‡å­—
    addStickers: false               // ä¸æ”¯æŒè´´çº¸
  }
  
  // å›¾ç‰‡å¤„ç†
  processing: {
    autoCompress: true               // è‡ªåŠ¨å‹ç¼©
    compressionQuality: 0.8          // å‹ç¼©è´¨é‡80%
    maxWidth: 1920                   // æœ€å¤§å®½åº¦
    maxHeight: 1920                  // æœ€å¤§é«˜åº¦
    thumbnailSize: 200               // ç¼©ç•¥å›¾å°ºå¯¸
    progressiveJPEG: true            // æ¸è¿›å¼JPEG
  }
  
  // å›¾ç‰‡é¢„è§ˆ
  preview: {
    fullScreen: true                 // å…¨å±é¢„è§ˆ
    pinchZoom: true                  // æåˆç¼©æ”¾
    swipeNavigation: true            // æ»‘åŠ¨åˆ‡æ¢
    saveToAlbum: true                // ä¿å­˜åˆ°ç›¸å†Œ
    shareToOther: true               // åˆ†äº«åˆ°å…¶ä»–åº”ç”¨
    imageInfo: true                  // æ˜¾ç¤ºå›¾ç‰‡ä¿¡æ¯
  }
}
```

### 4. è§†é¢‘æ¶ˆæ¯æ¨¡å—
```typescript
interface VideoMessageFeatures {
  // è§†é¢‘å½•åˆ¶ (æ‰©å±•WeChatCamera.vue)
  recording: {
    component: 'WeChatCamera.vue'    // æ‰©å±•ç°æœ‰ç»„ä»¶
    maxDuration: 60                  // æœ€å¤§60ç§’
    minDuration: 3                   // æœ€å°3ç§’
    resolution: ['720p', '1080p']    // åˆ†è¾¨ç‡é€‰é¡¹
    frameRate: 30                    // å¸§ç‡
    stabilization: true              // é˜²æŠ–åŠŸèƒ½
    realTimePreview: true            // å®æ—¶é¢„è§ˆ
  }
  
  // è§†é¢‘é€‰æ‹©
  gallery: {
    videoOnly: true                  // åªæ˜¾ç¤ºè§†é¢‘
    durationLimit: 300               // æœ€å¤§5åˆ†é’Ÿ
    sizeLimit: 100                   // æœ€å¤§100MB
    formatSupport: ['mp4', 'mov', 'avi']  // æ”¯æŒæ ¼å¼
    previewThumbnail: true           // é¢„è§ˆç¼©ç•¥å›¾
  }
  
  // è§†é¢‘ç¼–è¾‘
  editing: {
    trim: true                       // è£å‰ªæ—¶é•¿
    crop: false                      // ä¸æ”¯æŒç”»é¢è£å‰ª
    filters: ['åŸç‰‡', 'ç”µå½±', 'å¤å¤', 'é²œè‰³']  // æ»¤é•œ
    speedControl: [0.5, 1.0, 1.5, 2.0]  // æ’­æ”¾é€Ÿåº¦
    addMusic: false                  // ä¸æ”¯æŒæ·»åŠ éŸ³ä¹
    addText: false                   // ä¸æ”¯æŒæ·»åŠ æ–‡å­—
  }
  
  // è§†é¢‘æ’­æ”¾ (ä½¿ç”¨ç°æœ‰VideoPlayer.vue)
  playback: {
    component: 'VideoPlayer.vue'     // ç°æœ‰æ’­æ”¾å™¨
    autoPlay: false                  // ä¸è‡ªåŠ¨æ’­æ”¾
    controls: true                   // æ˜¾ç¤ºæ§åˆ¶æ¡
    fullScreen: true                 // å…¨å±æ’­æ”¾
    pictureInPicture: true           // ç”»ä¸­ç”»æ¨¡å¼
    playbackSpeed: true              // æ’­æ”¾é€Ÿåº¦æ§åˆ¶
    volumeControl: true              // éŸ³é‡æ§åˆ¶
  }
  
  // è§†é¢‘å¤„ç†
  processing: {
    autoCompress: true               // è‡ªåŠ¨å‹ç¼©
    compressionLevel: 'medium'       // å‹ç¼©çº§åˆ«
    thumbnailGenerate: true          // ç”Ÿæˆç¼©ç•¥å›¾
    thumbnailTime: 1                 // ç¬¬1ç§’ä½œä¸ºç¼©ç•¥å›¾
    progressiveDownload: true        // æ¸è¿›å¼ä¸‹è½½
  }
}
```

### 5. ä½ç½®æ¶ˆæ¯æ¨¡å—
```typescript
interface LocationMessageFeatures {
  // ä½ç½®è·å–
  positioning: {
    gpsAccuracy: 'high'              // é«˜ç²¾åº¦å®šä½
    timeout: 10000                   // 10ç§’è¶…æ—¶
    fallbackToNetwork: true          // ç½‘ç»œå®šä½å¤‡ç”¨
    cacheLocation: true              // ç¼“å­˜ä½ç½®ä¿¡æ¯
    backgroundLocation: false        // ä¸åå°å®šä½
  }
  
  // åœ°å›¾é€‰æ‹©
  mapSelection: {
    mapProvider: 'baidu'             // ç™¾åº¦åœ°å›¾
    searchPOI: true                  // æœç´¢å…´è¶£ç‚¹
    nearbyPOI: true                  // é™„è¿‘å…´è¶£ç‚¹
    customLocation: true             // è‡ªå®šä¹‰ä½ç½®
    locationHistory: true            // ä½ç½®å†å²
    favoriteLocations: true          // æ”¶è—ä½ç½®
  }
  
  // å®æ—¶ä½ç½®å…±äº«
  liveLocation: {
    enabled: true                    // å¯ç”¨åŠŸèƒ½
    duration: [15, 30, 60, 120]      // å…±äº«æ—¶é•¿(åˆ†é’Ÿ)
    updateInterval: 10               // 10ç§’æ›´æ–°é—´éš”
    accuracy: 'high'                 // é«˜ç²¾åº¦æ¨¡å¼
    batteryOptimized: true           // ç”µæ± ä¼˜åŒ–
    privacyControl: true             // éšç§æ§åˆ¶
  }
  
  // ä½ç½®æ˜¾ç¤º
  display: {
    staticMap: true                  // é™æ€åœ°å›¾æ˜¾ç¤º
    interactiveMap: true             // å¯äº¤äº’åœ°å›¾
    streetView: false                // ä¸æ”¯æŒè¡—æ™¯
    navigation: true                 // å¯¼èˆªåŠŸèƒ½
    distanceCalculation: true        // è·ç¦»è®¡ç®—
    addressDisplay: true             // åœ°å€æ˜¾ç¤º
  }
  
  // åœ°å€è§£æ
  geocoding: {
    reverseGeocode: true             // é€†åœ°ç†ç¼–ç 
    addressFormat: 'detailed'        // è¯¦ç»†åœ°å€æ ¼å¼
    languageSupport: ['zh-CN']       // ä¸­æ–‡æ”¯æŒ
    poiDetails: true                 // POIè¯¦ç»†ä¿¡æ¯
    administrativeArea: true         // è¡Œæ”¿åŒºåŸŸä¿¡æ¯
  }
}
```

### 6. çº¢åŒ…è½¬è´¦æ¨¡å—
```typescript
interface PaymentMessageFeatures {
  // çº¢åŒ…åŠŸèƒ½ (ä½¿ç”¨ç°æœ‰æ”¯ä»˜ç»„ä»¶)
  redpacket: {
    components: 'ç°æœ‰çº¢åŒ…ç»„ä»¶'         // å¤ç”¨ç°æœ‰ç»„ä»¶
    types: ['æ™®é€šçº¢åŒ…', 'æ‹¼æ‰‹æ°”çº¢åŒ…']   // çº¢åŒ…ç±»å‹
    minAmount: 0.01                  // æœ€å°é‡‘é¢
    maxAmount: 200                   // æœ€å¤§é‡‘é¢
    maxCount: 100                    // æœ€å¤§ä¸ªæ•°
    expiry: 24                       // 24å°æ—¶è¿‡æœŸ
    blessing: true                   // ç¥ç¦è¯­
    coverImage: true                 // å°é¢å›¾ç‰‡
  }
  
  // è½¬è´¦åŠŸèƒ½
  transfer: {
    components: 'ç°æœ‰è½¬è´¦ç»„ä»¶'         // å¤ç”¨ç°æœ‰ç»„ä»¶
    minAmount: 0.01                  // æœ€å°é‡‘é¢
    maxAmount: 5000                  // æœ€å¤§é‡‘é¢
    instantTransfer: true            // å³æ—¶åˆ°è´¦
    delayedTransfer: false           // ä¸æ”¯æŒå»¶æ—¶è½¬è´¦
    remark: true                     // è½¬è´¦å¤‡æ³¨
    confirmation: true               // ç¡®è®¤æœºåˆ¶
  }
  
  // æ”¯ä»˜éªŒè¯
  security: {
    paymentPassword: true            // æ”¯ä»˜å¯†ç 
    biometric: true                  // ç”Ÿç‰©è¯†åˆ«
    smsVerification: false           // ä¸éœ€è¦çŸ­ä¿¡éªŒè¯
    amountLimit: true                // é‡‘é¢é™åˆ¶
    dailyLimit: true                 // æ¯æ—¥é™é¢
    riskControl: true                // é£é™©æ§åˆ¶
  }
  
  // äº¤æ˜“è®°å½•
  records: {
    transactionHistory: true         // äº¤æ˜“å†å²
    detailView: true                 // è¯¦æƒ…æŸ¥çœ‹
    statusTracking: true             // çŠ¶æ€è·Ÿè¸ª
    receiptGeneration: true          // ç”Ÿæˆæ”¶æ®
    exportRecords: true              // å¯¼å‡ºè®°å½•
    searchFilter: true               // æœç´¢ç­›é€‰
  }
  
  // é’±åŒ…é›†æˆ
  wallet: {
    balanceDisplay: true             // ä½™é¢æ˜¾ç¤º
    recharge: true                   // å……å€¼åŠŸèƒ½
    withdraw: true                   // æç°åŠŸèƒ½
    bankCardBinding: true            // é“¶è¡Œå¡ç»‘å®š
    paymentMethods: true             // æ”¯ä»˜æ–¹å¼é€‰æ‹©
    securitySettings: true           // å®‰å…¨è®¾ç½®
  }
}
```

### 7. é€šè¯æ¨¡å—
```typescript
interface CallMessageFeatures {
  // éŸ³è§†é¢‘é€šè¯ (ä½¿ç”¨ç°æœ‰é€šè¯ç»„ä»¶)
  calling: {
    components: 'ç°æœ‰é€šè¯ç»„ä»¶'         // å¤ç”¨ç°æœ‰ç»„ä»¶
    voiceCall: true                  // è¯­éŸ³é€šè¯
    videoCall: true                  // è§†é¢‘é€šè¯
    groupCall: false                 // ä¸æ”¯æŒç¾¤ç»„é€šè¯
    callWaiting: true                // å‘¼å«ç­‰å¾…
    callForwarding: false            // ä¸æ”¯æŒå‘¼å«è½¬ç§»
  }
  
  // é€šè¯æ§åˆ¶
  controls: {
    mute: true                       // é™éŸ³æ§åˆ¶
    speaker: true                    // æ‰¬å£°å™¨åˆ‡æ¢
    cameraSwitch: true               // æ‘„åƒå¤´åˆ‡æ¢
    videoToggle: true                // è§†é¢‘å¼€å…³
    hangup: true                     // æŒ‚æ–­é€šè¯
    reject: true                     // æ‹’æ¥é€šè¯
  }
  
  // é€šè¯è´¨é‡
  quality: {
    adaptiveQuality: true            // è‡ªé€‚åº”è´¨é‡
    networkDetection: true           // ç½‘ç»œæ£€æµ‹
    qualityIndicator: true           // è´¨é‡æŒ‡ç¤ºå™¨
    autoAdjustment: true             // è‡ªåŠ¨è°ƒæ•´
    manualSettings: true             // æ‰‹åŠ¨è®¾ç½®
    callStatistics: true             // é€šè¯ç»Ÿè®¡
  }
  
  // é€šè¯è®°å½•
  records: {
    callHistory: true                // é€šè¯å†å²
    missedCalls: true                // æœªæ¥æ¥ç”µ
    callDuration: true               // é€šè¯æ—¶é•¿
    callTime: true                   // é€šè¯æ—¶é—´
    redial: true                     // é‡æ‹¨åŠŸèƒ½
    callDetails: true                // é€šè¯è¯¦æƒ…
  }
  
  // é€šè¯è®¾ç½®
  settings: {
    ringtone: true                   // é“ƒå£°è®¾ç½®
    vibration: true                  // æŒ¯åŠ¨è®¾ç½®
    autoAnswer: false                // ä¸è‡ªåŠ¨æ¥å¬
    callBlocking: true               // é€šè¯æ‹¦æˆª
    doNotDisturb: true               // å…æ‰“æ‰°æ¨¡å¼
    callPermissions: true            // é€šè¯æƒé™
  }
}
```

### 8. åç‰‡æ¶ˆæ¯æ¨¡å—
```typescript
interface ContactCardFeatures {
  // åç‰‡å‘é€ (ä½¿ç”¨ç°æœ‰è”ç³»äººç»„ä»¶)
  sending: {
    components: 'ç°æœ‰è”ç³»äººç»„ä»¶'       // å¤ç”¨ç°æœ‰ç»„ä»¶
    myCard: true                     // å‘é€æˆ‘çš„åç‰‡
    friendCard: true                 // å‘é€å¥½å‹åç‰‡
    multipleCards: true              // æ‰¹é‡å‘é€åç‰‡
    cardPreview: true                // åç‰‡é¢„è§ˆ
    customMessage: true              // è‡ªå®šä¹‰æ¶ˆæ¯
  }
  
  // åç‰‡ä¿¡æ¯
  cardInfo: {
    avatar: true                     // å¤´åƒ
    nickname: true                   // æ˜µç§°
    yeyuId: true                     // å¶è¯­å·
    phone: false                     // ä¸æ˜¾ç¤ºæ‰‹æœºå·
    email: false                     // ä¸æ˜¾ç¤ºé‚®ç®±
    company: false                   // ä¸æ˜¾ç¤ºå…¬å¸
    title: false                     // ä¸æ˜¾ç¤ºèŒä½
  }
  
  // åç‰‡æ“ä½œ
  actions: {
    addContact: true                 // æ·»åŠ è”ç³»äºº
    sendMessage: true                // å‘é€æ¶ˆæ¯
    voiceCall: true                  // è¯­éŸ³é€šè¯
    videoCall: true                  // è§†é¢‘é€šè¯
    viewProfile: true                // æŸ¥çœ‹èµ„æ–™
    blockUser: true                  // æ‹‰é»‘ç”¨æˆ·
  }
  
  // åç‰‡åˆ†äº«
  sharing: {
    qrCode: true                     // äºŒç»´ç åˆ†äº«
    linkShare: false                 // ä¸æ”¯æŒé“¾æ¥åˆ†äº«
    qrScan: true                     // æ‰«æäºŒç»´ç 
    nearbyShare: false               // ä¸æ”¯æŒé™„è¿‘åˆ†äº«
    socialShare: false               // ä¸æ”¯æŒç¤¾äº¤åˆ†äº«
  }
  
  // è”ç³»äººé›†æˆ
  integration: {
    contactSync: true                // è”ç³»äººåŒæ­¥
    friendRequest: true              // å¥½å‹è¯·æ±‚
    remarkName: true                 // å¤‡æ³¨åç§°
    contactGroups: false             // ä¸æ”¯æŒè”ç³»äººåˆ†ç»„
    favoriteContacts: true           // æ”¶è—è”ç³»äºº
  }
}
```

### 9. æ–‡ä»¶æ¶ˆæ¯æ¨¡å—
```typescript
interface FileMessageFeatures {
  // æ–‡ä»¶é€‰æ‹©
  selection: {
    fileTypes: ['pdf', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'txt', 'zip', 'rar']
    maxFileSize: 100                 // æœ€å¤§100MB
    multipleFiles: true              // å¤šæ–‡ä»¶é€‰æ‹©
    cloudFiles: false                // ä¸æ”¯æŒäº‘æ–‡ä»¶
    recentFiles: true                // æœ€è¿‘æ–‡ä»¶
  }
  
  // æ–‡ä»¶ä¸Šä¼ 
  upload: {
    progressIndicator: true          // è¿›åº¦æŒ‡ç¤ºå™¨
    pauseResume: true                // æš‚åœç»§ç»­
    backgroundUpload: true           // åå°ä¸Šä¼ 
    retryOnFailure: true             // å¤±è´¥é‡è¯•
    uploadQueue: true                // ä¸Šä¼ é˜Ÿåˆ—
    compressionOption: true          // å‹ç¼©é€‰é¡¹
  }
  
  // æ–‡ä»¶é¢„è§ˆ
  preview: {
    documentPreview: true            // æ–‡æ¡£é¢„è§ˆ
    imagePreview: true               // å›¾ç‰‡é¢„è§ˆ
    videoPreview: true               // è§†é¢‘é¢„è§ˆ
    audioPreview: true               // éŸ³é¢‘é¢„è§ˆ
    textPreview: true                // æ–‡æœ¬é¢„è§ˆ
    unsupportedFiles: 'æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯'   // ä¸æ”¯æŒçš„æ–‡ä»¶
  }
  
  // æ–‡ä»¶ä¸‹è½½
  download: {
    autoDownload: false              // ä¸è‡ªåŠ¨ä¸‹è½½
    manualDownload: true             // æ‰‹åŠ¨ä¸‹è½½
    downloadProgress: true           // ä¸‹è½½è¿›åº¦
    pauseResume: true                // æš‚åœç»§ç»­
    backgroundDownload: true         // åå°ä¸‹è½½
    downloadLocation: 'Downloads'    // ä¸‹è½½ä½ç½®
  }
  
  // æ–‡ä»¶ç®¡ç†
  management: {
    fileInfo: true                   // æ–‡ä»¶ä¿¡æ¯
    fileSize: true                   // æ–‡ä»¶å¤§å°
    uploadTime: true                 // ä¸Šä¼ æ—¶é—´
    expiryTime: true                 // è¿‡æœŸæ—¶é—´
    deleteFile: true                 // åˆ é™¤æ–‡ä»¶
    shareToOther: true               // åˆ†äº«åˆ°å…¶ä»–åº”ç”¨
  }
}
```

### 10. ç³»ç»Ÿæ¶ˆæ¯æ¨¡å—
```typescript
interface SystemMessageFeatures {
  // ç³»ç»Ÿé€šçŸ¥
  notifications: {
    joinGroup: true                  // åŠ å…¥ç¾¤ç»„
    leaveGroup: true                 // ç¦»å¼€ç¾¤ç»„
    groupNameChange: true            // ç¾¤åä¿®æ”¹
    memberPromote: true              // æˆå‘˜æå‡
    memberKick: true                 // æˆå‘˜è¸¢å‡º
    friendRequest: true              // å¥½å‹è¯·æ±‚
    friendAccept: true               // å¥½å‹æ¥å—
  }
  
  // æ¶ˆæ¯æ“ä½œ
  messageActions: {
    recall: true                     // æ¶ˆæ¯æ’¤å›
    forward: true                    // æ¶ˆæ¯è½¬å‘
    reply: true                      // æ¶ˆæ¯å›å¤
    quote: true                      // æ¶ˆæ¯å¼•ç”¨
    copy: true                       // å¤åˆ¶æ¶ˆæ¯
    delete: true                     // åˆ é™¤æ¶ˆæ¯
  }
  
  // çŠ¶æ€æ¶ˆæ¯
  statusMessages: {
    typing: true                     // æ­£åœ¨è¾“å…¥
    online: true                     // ä¸Šçº¿é€šçŸ¥
    offline: false                   // ä¸æ˜¾ç¤ºç¦»çº¿
    lastSeen: true                   // æœ€ååœ¨çº¿
    readReceipt: true                // å·²è¯»å›æ‰§
    deliveryReceipt: true            // é€è¾¾å›æ‰§
  }
  
  // æ¶ˆæ¯æœç´¢
  search: {
    globalSearch: true               // å…¨å±€æœç´¢
    chatSearch: true                 // èŠå¤©å†…æœç´¢
    messageType: true                // æŒ‰ç±»å‹æœç´¢
    dateRange: true                  // æ—¥æœŸèŒƒå›´
    senderFilter: true               // å‘é€è€…ç­›é€‰
    contentSearch: true              // å†…å®¹æœç´¢
  }
}
```

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### æ•°æ®å­˜å‚¨è¯¦ç»†è§„æ ¼
```typescript
interface StorageSpecification {
  // MySQLæœåŠ¡å™¨å­˜å‚¨
  mysql: {
    tables: {
      messages: 'æ¶ˆæ¯ä¸»è¡¨ï¼Œæ”¯æŒæ‰€æœ‰æ¶ˆæ¯ç±»å‹'
      chats: 'èŠå¤©åŸºæœ¬ä¿¡æ¯è¡¨'
      chat_members: 'èŠå¤©æˆå‘˜å’Œä¸ªäººè®¾ç½®è¡¨'
      users: 'ç”¨æˆ·ä¿¡æ¯è¡¨'
      friendships: 'å¥½å‹å…³ç³»è¡¨'
      media_files: 'åª’ä½“æ–‡ä»¶ç´¢å¼•è¡¨'
      payments: 'çº¢åŒ…è½¬è´¦è®°å½•è¡¨'
      call_records: 'é€šè¯è®°å½•è¡¨'
    }
    retention: {
      messages: '1å¹´è‡ªåŠ¨æ¸…ç†'
      media_files: '1ä¸ªæœˆè‡ªåŠ¨æ¸…ç†'
      payments: 'æ°¸ä¹…ä¿å­˜(ç›´åˆ°ç”¨æˆ·æ³¨é”€)'
      call_records: '90å¤©è‡ªåŠ¨æ¸…ç†'
    }
    performance: {
      indexing: 'å¤åˆç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢'
      partitioning: 'æŒ‰æ—¶é—´åˆ†åŒº'
      caching: 'RedisæŸ¥è¯¢ç¼“å­˜'
    }
  }

  // å®¢æˆ·ç«¯ç¼“å­˜å­˜å‚¨
  clientCache: {
    memory: {
      currentChat: 'å½“å‰èŠå¤©100æ¡æ¶ˆæ¯'
      chatList: 'æ‰€æœ‰èŠå¤©åˆ—è¡¨'
      userProfiles: 'å¸¸ç”¨ç”¨æˆ·èµ„æ–™'
      unreadCounts: 'æ‰€æœ‰æœªè¯»è®¡æ•°'
    }
    indexedDB: {
      messages: 'æ¯ä¸ªèŠå¤©æœ€å¤šç¼“å­˜200æ¡'
      chats: 'æ‰€æœ‰èŠå¤©ä¿¡æ¯'
      users: 'ç”¨æˆ·ä¿¡æ¯ç¼“å­˜6å°æ—¶'
      offlineQueue: 'ç¦»çº¿æ“ä½œé˜Ÿåˆ—'
    }
    localStorage: {
      settings: 'ç”¨æˆ·è®¾ç½®'
      tokens: 'è®¤è¯ä»¤ç‰Œ'
      config: 'åº”ç”¨é…ç½®'
    }
  }

  // æ–‡ä»¶å­˜å‚¨è§„æ ¼
  fileStorage: {
    server: {
      images: 'JPG/PNGï¼Œæœ€å¤§10MB'
      voices: 'MP3ï¼Œæœ€å¤§10MB'
      videos: 'MP4ï¼Œæœ€å¤§100MB'
      files: 'å„ç§æ ¼å¼ï¼Œæœ€å¤§100MB'
      retention: '1ä¸ªæœˆè‡ªåŠ¨æ¸…ç†'
    }
    client: {
      cacheSize: 'æœ€å¤§2GB'
      retention: '7å¤©è‡ªåŠ¨æ¸…ç†'
      compression: 'è‡ªåŠ¨å‹ç¼©ä¼˜åŒ–'
    }
  }
}
```

### å®æ—¶é€šä¿¡é›†æˆè§„æ ¼
```typescript
interface RealtimeIntegration {
  // ä½¿ç”¨ç°æœ‰ç»Ÿä¸€å®æ—¶æœåŠ¡
  service: 'window.unifiedRealtimeService'

  // æ¶ˆæ¯äº‹ä»¶ç›‘å¬
  messageEvents: {
    'chat.new_message': 'æ–°æ¶ˆæ¯æ¥æ”¶'
    'chat.message_status': 'æ¶ˆæ¯çŠ¶æ€æ›´æ–°'
    'chat.typing': 'æ­£åœ¨è¾“å…¥çŠ¶æ€'
    'chat.read_receipt': 'å·²è¯»å›æ‰§'
  }

  // ç”¨æˆ·çŠ¶æ€äº‹ä»¶
  userEvents: {
    'presence.user_online': 'ç”¨æˆ·ä¸Šçº¿'
    'presence.user_offline': 'ç”¨æˆ·ç¦»çº¿'
    'presence.user_status': 'ç”¨æˆ·çŠ¶æ€å˜æ›´'
  }

  // é€šè¯äº‹ä»¶
  callEvents: {
    'call.invite': 'é€šè¯é‚€è¯·'
    'call.accept': 'æ¥å—é€šè¯'
    'call.reject': 'æ‹’ç»é€šè¯'
    'call.end': 'ç»“æŸé€šè¯'
  }

  // ç³»ç»Ÿäº‹ä»¶
  systemEvents: {
    'system.friend_request': 'å¥½å‹è¯·æ±‚'
    'system.group_invite': 'ç¾¤ç»„é‚€è¯·'
    'system.notification': 'ç³»ç»Ÿé€šçŸ¥'
  }
}
```

### ç°æœ‰ç»„ä»¶é›†æˆè§„æ ¼
```typescript
interface ExistingComponentsIntegration {
  // èŠå¤©ç›¸å…³ç»„ä»¶
  chat: {
    'ChatList.vue': 'èŠå¤©åˆ—è¡¨ - ä¿®æ”¹æ•°æ®æºä¸ºæ–°messageStore'
    'ChatPage.vue': 'èŠå¤©é¡µé¢ - é€‚é…æ–°çš„æ¶ˆæ¯å¤„ç†é€»è¾‘'
    'MobileTopBar.vue': 'é¡¶éƒ¨å¯¼èˆª - æ˜¾ç¤ºèŠå¤©æ ‡é¢˜å’Œåœ¨çº¿çŠ¶æ€'
    'MobileTabBar.vue': 'åº•éƒ¨å¯¼èˆª - æ˜¾ç¤ºæœªè¯»è®¡æ•°çº¢ç‚¹'
  }

  // åª’ä½“ç›¸å…³ç»„ä»¶
  media: {
    'VoiceRecorder.vue': 'è¯­éŸ³å½•åˆ¶ - é›†æˆåˆ°æ¶ˆæ¯è¾“å…¥'
    'WeChatCamera.vue': 'ç›¸æœºç»„ä»¶ - é›†æˆæ‹ç…§å½•åƒåŠŸèƒ½'
    'VideoPlayer.vue': 'è§†é¢‘æ’­æ”¾ - ç”¨äºè§†é¢‘æ¶ˆæ¯æ’­æ”¾'
    'EmojiPicker.vue': 'è¡¨æƒ…é€‰æ‹© - é›†æˆåˆ°æ–‡æœ¬è¾“å…¥'
  }

  // åŠŸèƒ½ç»„ä»¶
  features: {
    'ç°æœ‰æ”¯ä»˜ç»„ä»¶': 'çº¢åŒ…è½¬è´¦ - é›†æˆåˆ°èŠå¤©åŠŸèƒ½'
    'ç°æœ‰é€šè¯ç»„ä»¶': 'éŸ³è§†é¢‘é€šè¯ - é›†æˆé€šè¯å‘èµ·å’Œæ§åˆ¶'
    'ç°æœ‰è”ç³»äººç»„ä»¶': 'è”ç³»äººé€‰æ‹© - ç”¨äºåç‰‡å‘é€'
    'UnifiedAvatar.vue': 'ç»Ÿä¸€å¤´åƒ - ç”¨äºç”¨æˆ·å¤´åƒæ˜¾ç¤º'
  }

  // é›†æˆåŸåˆ™
  principles: {
    noModification: 'ä¸ä¿®æ”¹ç°æœ‰ç»„ä»¶ä»£ç ç»“æ„'
    dataSourceChange: 'åªä¿®æ”¹ç»„ä»¶çš„æ•°æ®æº'
    eventHandling: 'é€‚é…ç»„ä»¶çš„äº‹ä»¶å¤„ç†'
    propsAdaptation: 'é€‚é…ç»„ä»¶çš„propsä¼ é€’'
  }
}
```

### æ•°æ®æ¸…ç†å’Œéšç§è§„æ ¼
```typescript
interface DataPrivacySpecification {
  // è‡ªåŠ¨æ¸…ç†ç­–ç•¥
  autoCleanup: {
    textMessages: {
      client: '1å¹´åæ¸…ç†'
      server: '1å¹´åæ¸…ç†'
    }
    mediaMessages: {
      client: '7å¤©åæ¸…ç†'
      server: '1ä¸ªæœˆåæ¸…ç†'
    }
    redpacketTransfer: {
      client: 'æ°¸ä¹…ä¿å­˜'
      server: 'æ°¸ä¹…ä¿å­˜(ç›´åˆ°ç”¨æˆ·æ³¨é”€)'
    }
    callRecords: {
      client: '30å¤©åæ¸…ç†'
      server: '90å¤©åæ¸…ç†'
    }
  }

  // ç”¨æˆ·æ“ä½œæ¸…ç†
  userActions: {
    deleteChatItem: {
      action: 'åˆ é™¤èŠå¤©é¡¹'
      scope: 'æ¸…ç†æœ¬åœ°æ‰€æœ‰ç›¸å…³æ•°æ®'
      server: 'æœåŠ¡å™¨æ•°æ®ä¿ç•™'
      recovery: 'ä¸å¯æ¢å¤'
    }
    accountDeletion: {
      action: 'ç”¨æˆ·æ³¨é”€'
      scope: 'æ¸…ç†æ‰€æœ‰èŠå¤©ç›¸å…³æ•°æ®'
      preserve: 'ä¿ç•™æ—è°±æ•°æ®'
      server: 'æœåŠ¡å™¨ç«¯å®Œå…¨æ¸…ç†'
    }
    deviceChange: {
      action: 'æ¢è®¾å¤‡ç™»å½•'
      scope: 'ä¸æ¢å¤å†å²æ•°æ®'
      newDevice: 'åªèƒ½æ¥æ”¶æ–°æ¶ˆæ¯'
    }
  }

  // é»‘åå•æœºåˆ¶
  blacklist: {
    messageBlocking: 'è‡ªåŠ¨æ‹’æ”¶é»‘åå•ç”¨æˆ·æ¶ˆæ¯'
    callBlocking: 'è‡ªåŠ¨æ‹’ç»é»‘åå•ç”¨æˆ·é€šè¯'
    statusHiding: 'éšè—åœ¨çº¿çŠ¶æ€'
    notificationBlock: 'å±è”½æ‰€æœ‰é€šçŸ¥'
  }
}
```

### æ€§èƒ½ä¼˜åŒ–è§„æ ¼
```typescript
interface PerformanceSpecification {
  // å“åº”æ—¶é—´ç›®æ ‡
  responseTime: {
    messageSend: '< 100ms'
    chatListLoad: '< 200ms'
    imageLoad: '< 500ms'
    videoLoad: '< 1000ms'
    searchResults: '< 300ms'
  }

  // å†…å­˜ä½¿ç”¨ç›®æ ‡
  memoryUsage: {
    maxMemory: '< 200MB'
    messageCache: '< 50MB'
    imageCache: '< 100MB'
    videoCache: '< 50MB'
  }

  // ç½‘ç»œä¼˜åŒ–
  networkOptimization: {
    batchRequests: 'æ‰¹é‡è¯·æ±‚å‡å°‘ç½‘ç»œå¾€è¿”'
    compression: 'æ•°æ®å‹ç¼©ä¼ è¾“'
    caching: 'æ™ºèƒ½ç¼“å­˜ç­–ç•¥'
    preloading: 'é¢„åŠ è½½å¸¸ç”¨æ•°æ®'
  }

  // æ•°æ®åº“ä¼˜åŒ–
  databaseOptimization: {
    indexing: 'å¤åˆç´¢å¼•ä¼˜åŒ–'
    partitioning: 'è¡¨åˆ†åŒºç­–ç•¥'
    queryOptimization: 'æŸ¥è¯¢è¯­å¥ä¼˜åŒ–'
    connectionPooling: 'è¿æ¥æ± ç®¡ç†'
  }
}
```

## ğŸ¯ å¼€å‘ä¼˜å…ˆçº§å’Œä¾èµ–å…³ç³»

### å¼€å‘é¡ºåº
1. **åŸºç¡€æ¶æ„** (MySQL + ç¼“å­˜ + messageStore)
2. **æ–‡æœ¬æ¶ˆæ¯** (éªŒè¯æ•´ä¸ªæµç¨‹)
3. **è¯­éŸ³æ¶ˆæ¯** (VoiceRecorderé›†æˆ)
4. **å›¾ç‰‡æ¶ˆæ¯** (WeChatCameraé›†æˆ)
5. **è§†é¢‘æ¶ˆæ¯** (VideoPlayeré›†æˆ)
6. **ä½ç½®æ¶ˆæ¯** (åœ°å›¾APIé›†æˆ)
7. **çº¢åŒ…è½¬è´¦** (ç°æœ‰æ”¯ä»˜ç»„ä»¶é›†æˆ)
8. **é€šè¯åŠŸèƒ½** (ç°æœ‰é€šè¯ç»„ä»¶é›†æˆ)
9. **åç‰‡æ–‡ä»¶** (è”ç³»äººç»„ä»¶é›†æˆ)
10. **ç³»ç»Ÿæ¶ˆæ¯** (é«˜çº§åŠŸèƒ½)
11. **æ•°æ®ç®¡ç†** (æ¸…ç†å’Œå®‰å…¨)
12. **æ€§èƒ½ä¼˜åŒ–** (æœ€ç»ˆä¼˜åŒ–)

### å…³é”®ä¾èµ–
- MySQLæ•°æ®åº“è®¾è®¡ â†’ æ‰€æœ‰åŠŸèƒ½çš„åŸºç¡€
- å®¢æˆ·ç«¯ç¼“å­˜ç³»ç»Ÿ â†’ æ€§èƒ½å’Œç¦»çº¿æ”¯æŒ
- ç»Ÿä¸€å®æ—¶æœåŠ¡é›†æˆ â†’ å®æ—¶æ¶ˆæ¯æ”¶å‘
- ç°æœ‰ç»„ä»¶é€‚é… â†’ UIåŠŸèƒ½å®ç°

è¿™ä¸ªè¯¦ç»†çš„åŠŸèƒ½è§„æ ¼ç¡®ä¿äº†å¼€å‘è¿‡ç¨‹ä¸­çš„æ¯ä¸ªç»†èŠ‚éƒ½æœ‰æ˜ç¡®çš„æ ‡å‡†å’Œè¦æ±‚ã€‚
```
